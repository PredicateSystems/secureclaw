{
  "rules": [
    {
      "name": "block-filesystem-write",
      "effect": "deny",
      "principals": ["*"],
      "actions": [
        "fs.write",
        "fs.write_file",
        "fs.create",
        "fs.append",
        "file.write",
        "write",
        "edit"
      ],
      "resources": ["*"]
    },
    {
      "name": "block-filesystem-delete",
      "effect": "deny",
      "principals": ["*"],
      "actions": [
        "fs.delete",
        "fs.remove",
        "fs.unlink",
        "fs.rmdir",
        "fs.rm",
        "file.delete",
        "delete"
      ],
      "resources": ["*"]
    },
    {
      "name": "block-filesystem-modify",
      "effect": "deny",
      "principals": ["*"],
      "actions": [
        "fs.rename",
        "fs.move",
        "fs.copy",
        "fs.mkdir",
        "fs.chmod",
        "fs.chown",
        "fs.truncate",
        "file.rename",
        "file.move"
      ],
      "resources": ["*"]
    },
    {
      "name": "block-sensitive-file-read",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["fs.read", "fs.read_file", "file.read", "read"],
      "resources": [
        "/etc/passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "/etc/ssh/*",
        "*/.ssh/id_*",
        "*/.ssh/known_hosts",
        "*/.ssh/authorized_keys",
        "*/.aws/credentials",
        "*/.aws/config",
        "*/.config/gcloud/*",
        "*/.azure/*",
        "*/.kube/config",
        "*/.npmrc",
        "*/.pypirc",
        "*/.netrc",
        "*/.env",
        "*/.env.*",
        "**/.env",
        "**/.env.*",
        "**/credentials*",
        "**/secrets*",
        "**/*.pem",
        "**/*.key",
        "**/id_rsa*",
        "**/id_ed25519*"
      ]
    },
    {
      "name": "block-dangerous-shell-commands",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["shell.exec", "bash", "exec", "run"],
      "resources": [
        "rm *",
        "rm -rf *",
        "rmdir *",
        "unlink *",
        "shred *",
        "mv *",
        "cp *",
        "mkdir *",
        "touch *",
        "chmod *",
        "chown *",
        "chgrp *",
        "sudo *",
        "su *",
        "doas *",
        "pkexec *",
        "apt *",
        "apt-get *",
        "yum *",
        "dnf *",
        "pacman *",
        "brew *",
        "npm *",
        "pip *",
        "pip3 *",
        "curl * | bash*",
        "curl * | sh*",
        "wget * | bash*",
        "wget * | sh*",
        "git push*",
        "git commit*",
        "git reset*",
        "git checkout*",
        "git branch -d*",
        "git branch -D*",
        "vi *",
        "vim *",
        "nano *",
        "emacs *",
        "sed -i*",
        "awk -i*"
      ]
    },
    {
      "name": "block-http-mutations",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["http.post", "http.put", "http.patch", "http.delete"],
      "resources": ["*"]
    },
    {
      "name": "block-browser-mutations",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["browser.click", "browser.type", "browser.fill", "browser.submit"],
      "resources": ["*"]
    },
    {
      "name": "allow-filesystem-read",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "fs.read",
        "fs.read_file",
        "fs.list",
        "fs.readdir",
        "fs.stat",
        "fs.exists",
        "fs.access",
        "file.read",
        "read"
      ],
      "resources": ["*"]
    },
    {
      "name": "allow-filesystem-search",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["fs.glob", "fs.find", "fs.search", "glob", "grep"],
      "resources": ["*"]
    },
    {
      "name": "allow-readonly-shell-commands",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["shell.exec", "bash", "exec", "run"],
      "resources": [
        "cat *",
        "head *",
        "tail *",
        "less *",
        "more *",
        "bat *",
        "ls *",
        "ls",
        "ll *",
        "tree *",
        "exa *",
        "find *",
        "locate *",
        "which *",
        "whereis *",
        "type *",
        "grep *",
        "rg *",
        "ag *",
        "ack *",
        "wc *",
        "sort *",
        "uniq *",
        "cut *",
        "awk *",
        "sed *",
        "jq *",
        "yq *",
        "pwd",
        "whoami",
        "hostname",
        "uname *",
        "date",
        "uptime",
        "df *",
        "du *",
        "free *",
        "top -b*",
        "ps *",
        "env",
        "printenv*",
        "git status*",
        "git log*",
        "git diff*",
        "git show*",
        "git branch*",
        "git remote*",
        "git rev-parse*",
        "git ls-files*",
        "git blame*",
        "wc -l*",
        "cloc *",
        "tokei *",
        "file *",
        "stat *"
      ]
    },
    {
      "name": "allow-https-get-requests",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["http.get", "http.request", "fetch", "browser.navigate", "browser.goto"],
      "resources": ["https://*"]
    },
    {
      "name": "allow-browser-read-operations",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "browser.snapshot",
        "browser.screenshot",
        "browser.read",
        "browser.extract",
        "browser.get_text",
        "browser.get_html",
        "browser.get_state",
        "browser.scroll",
        "browser.wait"
      ],
      "resources": ["*"]
    },
    {
      "name": "default-deny",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["*"],
      "resources": ["*"]
    }
  ]
}
