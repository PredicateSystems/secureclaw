{
  "version": "1.0",
  "metadata": {
    "name": "strict",
    "description": "Balanced production policy with workspace isolation",
    "environment": "production"
  },
  "rules": [
    {
      "name": "block-sensitive-files",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["fs.read", "fs.write", "fs.delete", "fs.*", "file.*", "read", "write", "edit"],
      "resources": [
        "**/.env",
        "**/.env.*",
        "**/credentials*",
        "**/secrets*",
        "**/*.pem",
        "**/*.key",
        "**/*.p12",
        "**/*.pfx",
        "*/.ssh/*",
        "/etc/ssh/*",
        "*/.aws/*",
        "*/.azure/*",
        "*/.config/gcloud/*",
        "*/.kube/config",
        "*/.npmrc",
        "*/.pypirc",
        "*/.netrc",
        "*/.docker/config.json",
        "/etc/passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "/etc/sudoers.d/*"
      ],
      "required_labels": []
    },
    {
      "name": "block-outside-workspace",
      "effect": "deny",
      "principals": ["*"],
      "actions": [
        "fs.write",
        "fs.delete",
        "fs.create",
        "fs.mkdir",
        "fs.rmdir",
        "fs.rename",
        "file.write",
        "file.delete",
        "write",
        "edit",
        "delete"
      ],
      "resources": [
        "/etc/*",
        "/usr/*",
        "/bin/*",
        "/sbin/*",
        "/var/*",
        "/tmp/*",
        "/System/*",
        "/Library/*",
        "/Applications/*",
        "C:\\Windows\\*",
        "C:\\Program Files*"
      ],
      "required_labels": []
    },
    {
      "name": "block-dangerous-commands",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["shell.exec", "bash", "exec", "run"],
      "resources": [
        "rm -rf /*",
        "rm -rf /",
        "rm -rf ~/*",
        ":(){ :|:& };:*",
        "dd if=/dev/zero*",
        "mkfs*",
        "> /dev/sd*",
        "sudo *",
        "su *",
        "doas *",
        "pkexec *",
        "runas *",
        "chmod 777*",
        "chmod -R 777*",
        "chown root*",
        "curl * | bash*",
        "curl * | sh*",
        "wget * | bash*",
        "wget * | sh*",
        "nc -l*",
        "ncat -l*",
        "*cat*id_rsa*",
        "*cat*.pem*",
        "echo $*_KEY*",
        "echo $*_SECRET*",
        "echo $*_TOKEN*",
        "printenv*KEY*",
        "printenv*SECRET*"
      ],
      "required_labels": []
    },
    {
      "name": "block-insecure-protocols",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["http.request", "http.get", "http.post", "fetch", "browser.navigate"],
      "resources": ["http://*", "ftp://*", "file://*", "data:text/html*", "javascript:*"],
      "required_labels": []
    },
    {
      "name": "allow-workspace-read",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "fs.read",
        "fs.read_file",
        "fs.list",
        "fs.readdir",
        "fs.stat",
        "fs.exists",
        "fs.glob",
        "file.read",
        "read",
        "glob",
        "grep"
      ],
      "resources": ["*"],
      "required_labels": []
    },
    {
      "name": "allow-workspace-write",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "fs.write",
        "fs.write_file",
        "fs.create",
        "fs.mkdir",
        "file.write",
        "write",
        "edit"
      ],
      "resources": [
        "*/workspace/*",
        "*/projects/*",
        "*/src/*",
        "*/code/*",
        "*/.secureclaw/*",
        "*/Downloads/*",
        "*/Documents/*",
        "./*",
        "src/*",
        "lib/*",
        "test/*",
        "tests/*",
        "docs/*"
      ],
      "required_labels": ["intent_verified"]
    },
    {
      "name": "allow-workspace-delete",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["fs.delete", "fs.remove", "fs.rmdir", "file.delete", "delete"],
      "resources": ["*/workspace/*", "*/projects/*", "*/.secureclaw/*", "./*"],
      "required_labels": ["intent_verified", "deletion_confirmed"]
    },
    {
      "name": "allow-safe-shell-commands",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["shell.exec", "bash", "exec", "run"],
      "resources": [
        "cat *",
        "head *",
        "tail *",
        "less *",
        "bat *",
        "ls*",
        "tree *",
        "pwd",
        "cd *",
        "find *",
        "grep *",
        "rg *",
        "ag *",
        "wc *",
        "sort *",
        "uniq *",
        "cut *",
        "awk *",
        "sed *",
        "jq *",
        "whoami",
        "hostname",
        "uname *",
        "date",
        "env",
        "which *",
        "node *",
        "npm run*",
        "npm test*",
        "npm install*",
        "npx *",
        "pnpm *",
        "yarn *",
        "bun *",
        "python *",
        "python3 *",
        "pip install*",
        "cargo *",
        "go *",
        "make *",
        "git *",
        "docker ps*",
        "docker images*",
        "docker logs*"
      ],
      "required_labels": []
    },
    {
      "name": "allow-build-commands",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["shell.exec", "bash", "exec"],
      "resources": [
        "npm run build*",
        "npm run test*",
        "pnpm build*",
        "pnpm test*",
        "yarn build*",
        "yarn test*",
        "make build*",
        "make test*",
        "cargo build*",
        "cargo test*",
        "go build*",
        "go test*"
      ],
      "required_labels": ["intent_verified"]
    },
    {
      "name": "allow-https-requests",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "http.request",
        "http.get",
        "http.post",
        "http.put",
        "http.patch",
        "http.delete",
        "fetch"
      ],
      "resources": ["https://*"],
      "required_labels": []
    },
    {
      "name": "allow-browser-navigation",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": ["browser.navigate", "browser.goto"],
      "resources": ["https://*"],
      "required_labels": ["browser_initialized"]
    },
    {
      "name": "allow-browser-interactions",
      "effect": "allow",
      "principals": ["agent:*"],
      "actions": [
        "browser.snapshot",
        "browser.screenshot",
        "browser.click",
        "browser.type",
        "browser.fill",
        "browser.scroll",
        "browser.wait",
        "browser.read",
        "browser.extract"
      ],
      "resources": ["*"],
      "required_labels": ["browser_initialized", "snapshot_captured"]
    },
    {
      "name": "default-deny",
      "effect": "deny",
      "principals": ["*"],
      "actions": ["*"],
      "resources": ["*"],
      "required_labels": []
    }
  ]
}
